<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Auto-discovery mechanism for ACME servers</title>
<meta content="Paul van Brouwershaven" name="author">
<meta content="Mike Ounsworth" name="author">
<meta content="Corey Bonnell" name="author">
<meta content="Iñigo Barreira" name="author">
<meta content="Q Misell" name="author">
<meta content="
       A significant impediment to the widespread adoption of the Automated Certificate Management Environment (ACME)   is that ACME clients need to be pre-configured with the URL of the ACME server to be used. This often leaves domain owners at the mercy of their hosting provider as to which Certification Authorities (CAs) can be used. This specification provides a mechanism to bootstrap ACME client configuration from a domain's DNS CAA Resource Record  , thus giving control of which CA(s) to use back to the domain owner. 
       Specifically, this document specifies two new extensions to the DNS CAA Resource Record: the &quot;discovery&quot; and &quot;priority&quot; parameters. Additionally, it registers the URI &quot;/.well-known/acme&quot; at which all compliant ACME servers will host their ACME directory object. By retrieving instructions for the ACME client from the authorized CA(s), this mechanism allows for the domain owner to configure multiple CAs in either load-balanced or fallback prioritizations which improves user preferences and increases diversity in certificate issuers. 
    " name="description">
<meta content="xml2rfc 3.26.0" name="generator">
<meta content="ACME" name="keyword">
<meta content="Auto-discovery" name="keyword">
<meta content="CAA" name="keyword">
<meta content="draft-vanbrouwershaven-acme-auto-discovery-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.26.0
    Python 3.12.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-vanbrouwershaven-acme-auto-discovery.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ACME Server Discovery</td>
<td class="right">February 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">van Brouwershaven, et al.</td>
<td class="center">Expires 17 August 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACME</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-vanbrouwershaven-acme-auto-discovery-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-02-13" class="published">13 February 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-08-17">17 August 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. van Brouwershaven</div>
<div class="org">Entrust</div>
</div>
<div class="author">
      <div class="author-name">M. Ounsworth</div>
<div class="org">Entrust</div>
</div>
<div class="author">
      <div class="author-name">C. Bonnell</div>
<div class="org">DigiCert</div>
</div>
<div class="author">
      <div class="author-name">I. Barreira</div>
<div class="org">Sectigo</div>
</div>
<div class="author">
      <div class="author-name">Q. Misell</div>
<div class="org">AS207960</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Auto-discovery mechanism for ACME servers</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">A significant impediment to the widespread adoption of the Automated Certificate Management Environment (ACME) <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span> is that ACME clients need to be pre-configured with the URL of the ACME server to be used. This often leaves domain owners at the mercy of their hosting provider as to which Certification Authorities (CAs) can be used. This specification provides a mechanism to bootstrap ACME client configuration from a domain's DNS CAA Resource Record <span>[<a href="#RFC8659" class="cite xref">RFC8659</a>]</span>, thus giving control of which CA(s) to use back to the domain owner.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Specifically, this document specifies two new extensions to the DNS CAA Resource Record: the "discovery" and "priority" parameters. Additionally, it registers the URI "/.well-known/acme" at which all compliant ACME servers will host their ACME directory object. By retrieving instructions for the ACME client from the authorized CA(s), this mechanism allows for the domain owner to configure multiple CAs in either load-balanced or fallback prioritizations which improves user preferences and increases diversity in certificate issuers.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://vanbroup.github.io/acme-auto-discovery/draft-vanbrouwershaven-acme-auto-discovery.html">https://vanbroup.github.io/acme-auto-discovery/draft-vanbrouwershaven-acme-auto-discovery.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-vanbrouwershaven-acme-auto-discovery/">https://datatracker.ietf.org/doc/draft-vanbrouwershaven-acme-auto-discovery/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        ACME Working Group mailing list (<span><a href="mailto:acme@ietf.org">mailto:acme@ietf.org</a></span>),
        which is archived at <span><a href="https://datatracker.ietf.org/wg/acme/about/">https://datatracker.ietf.org/wg/acme/about/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/acme/">https://www.ietf.org/mailman/listinfo/acme/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/vanbroup/acme-auto-discovery">https://github.com/vanbroup/acme-auto-discovery</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 17 August 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-caa-record" class="internal xref">CAA Record</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-extensions-to-the-caa-recor" class="internal xref">Extensions to the CAA Record</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-the-discovery-parameter" class="internal xref">The "discovery" Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-the-priority-parameter" class="internal xref">The "priority" Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-single-ca" class="internal xref">Single CA</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-multiple-cas-with-priority" class="internal xref">Multiple CAs with priority</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-using-validationmethods" class="internal xref">Using validationmethods</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="auto internal xref">4.2.4</a>.  <a href="#name-using-issuewild" class="internal xref">Using issuewild</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5">
                    <p id="section-toc.1-1.4.2.2.2.5.1"><a href="#section-4.2.5" class="auto internal xref">4.2.5</a>.  <a href="#name-using-accounturi" class="internal xref">Using accounturi</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-acme-client-configuration" class="internal xref">ACME Client Configuration</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-acme-client-behavior" class="internal xref">ACME Client Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-certificates-with-multiple-" class="internal xref">Certificates with multiple domain names</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-selecting-a-ca-through-comp" class="internal xref">Selecting a CA through Compromise</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-external-account-binding" class="internal xref">External Account Binding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-internal-account-binding-us" class="internal xref">Internal Account Binding using Domain Control Validation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="auto internal xref">7.1.2</a>.  <a href="#name-internal-account-binding-usi" class="internal xref">Internal Account Binding using Email Address</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-terms-of-service-and-accept" class="internal xref">Terms of Service and Acceptance</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-implicit-acceptance-of-term" class="internal xref">Implicit Acceptance of Terms of Service</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-acceptance-through-caa-para" class="internal xref">Acceptance Through CAA Parameter</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-well-known-uri-for-the-acme" class="internal xref">Well-Known URI for the ACME Directory</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-caa-parameters" class="internal xref">CAA Parameters</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-risks-with-auto-discovery-o" class="internal xref">Risks with Auto-Discovery of Authorized CAs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="auto internal xref">9.1.1</a>.  <a href="#name-unexpected-certificate-issu" class="internal xref">Unexpected Certificate Issuance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-9.1.2" class="auto internal xref">9.1.2</a>.  <a href="#name-issuance-by-the-wrong-autho" class="internal xref">Issuance by the ‘wrong’ authorized CA</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-malicious-acme-servers" class="internal xref">Malicious ACME Servers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-authorization-of-acme-keys" class="internal xref">Authorization of ACME Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-use-of-dns-security" class="internal xref">Use of DNS Security</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-1">
      <h2 id="name-conventions-and-definitions">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-intro">
<section id="section-2">
      <h2 id="name-introduction">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-2-1">The ACME protocol <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span> offers a powerful framework for automating the issuance and validation of certificates, eliminating the need for user intervention. This capability has significantly streamlined the process of obtaining certificates for servers and infrastructure software. However, in shared environments, where multiple entities coexist, users often face limitations in modifying ACME client configurations. Consequently, they are forced to rely on manual certificate management systems or default Certificate Authorities (CAs) preconfigured for the shared environment.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document introduces a mechanism to address the aforementioned challenge by enabling the automatic discovery of ACME client configurations for relevant domain names within a shared environment. The solution leverages the DNS Certification Authority Authorization (CAA) Resource Record <span>[<a href="#RFC8659" class="cite xref">RFC8659</a>]</span> to identify the authorized Certification Authorities capable of issuing certificates for a specific domain name or set of domain names.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">By leveraging the power of CAA records, this mechanism empowers users with enhanced control and flexibility. Users can specify their preferences, choose from a broader range of certificate issuers, and even designate a backup Certification Authority.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">This approach facilitates a more diverse and adaptable certificate management process within shared and managed environments.
This document provides a detailed description of the proposed mechanism, along with its benefits and considerations.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Additionally, it outlines the security aspects associated with the use of CAA records for ACME client configuration discovery. Finally, this document presents IANA considerations and references relevant normative and informative documents.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">There is previous work in this area in <span>[<a href="#I-D.tweedale-acme-discovery" class="cite xref">I-D.tweedale-acme-discovery</a>]</span> which attempts to solve a similar ACME discovery problem for private networks and private ACME CAs.<a href="#section-2-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-7.1">
          <p id="section-2-7.1.1"><strong>RFC Editor's Note:</strong>  Please remove this section prior to publication of a final version of this document.<a href="#section-2-7.1.1" class="pilcrow">¶</a></p>
<p id="section-2-7.1.2">The authors of the document considered both SRV and URI DNS resource record types as an alternative to the proposed Well-Known URI, see also: https://github.com/vanbroup/acme-auto-discovery/issues/15<a href="#section-2-7.1.2" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="protocol-overview">
<section id="section-3">
      <h2 id="name-protocol-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<div id="section-3-1">
        <div class="alignLeft art-svg artwork" id="section-3-1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="480" width="560" viewBox="0 0 560 480" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
            <path d="M 8,32 L 8,128" fill="none" stroke="black"></path>
            <path d="M 80,136 L 80,432" fill="none" stroke="black"></path>
            <path d="M 96,128 L 96,304" fill="none" stroke="black"></path>
            <path d="M 120,32 L 120,128" fill="none" stroke="black"></path>
            <path d="M 208,112 L 208,176" fill="none" stroke="black"></path>
            <path d="M 336,32 L 336,96" fill="none" stroke="black"></path>
            <path d="M 336,144 L 336,240" fill="none" stroke="black"></path>
            <path d="M 336,272 L 336,352" fill="none" stroke="black"></path>
            <path d="M 336,400 L 336,464" fill="none" stroke="black"></path>
            <path d="M 440,96 L 440,136" fill="none" stroke="black"></path>
            <path d="M 440,352 L 440,392" fill="none" stroke="black"></path>
            <path d="M 552,32 L 552,96" fill="none" stroke="black"></path>
            <path d="M 552,144 L 552,240" fill="none" stroke="black"></path>
            <path d="M 552,272 L 552,352" fill="none" stroke="black"></path>
            <path d="M 552,400 L 552,464" fill="none" stroke="black"></path>
            <path d="M 8,32 L 120,32" fill="none" stroke="black"></path>
            <path d="M 336,32 L 552,32" fill="none" stroke="black"></path>
            <path d="M 120,80 L 328,80" fill="none" stroke="black"></path>
            <path d="M 336,96 L 552,96" fill="none" stroke="black"></path>
            <path d="M 128,112 L 208,112" fill="none" stroke="black"></path>
            <path d="M 8,128 L 120,128" fill="none" stroke="black"></path>
            <path d="M 336,144 L 552,144" fill="none" stroke="black"></path>
            <path d="M 208,176 L 336,176" fill="none" stroke="black"></path>
            <path d="M 336,240 L 552,240" fill="none" stroke="black"></path>
            <path d="M 336,272 L 552,272" fill="none" stroke="black"></path>
            <path d="M 96,304 L 328,304" fill="none" stroke="black"></path>
            <path d="M 336,352 L 552,352" fill="none" stroke="black"></path>
            <path d="M 336,400 L 552,400" fill="none" stroke="black"></path>
            <path d="M 80,432 L 336,432" fill="none" stroke="black"></path>
            <path d="M 336,464 L 552,464" fill="none" stroke="black"></path>
            <path d="M 496,320 L 504,304" fill="none" stroke="black"></path>
            <polygon class="arrowhead" points="448,392 436,386.4 436,397.6" fill="black" transform="rotate(90,440,392)"></polygon>
            <polygon class="arrowhead" points="448,136 436,130.4 436,141.6" fill="black" transform="rotate(90,440,136)"></polygon>
            <polygon class="arrowhead" points="336,304 324,298.4 324,309.6" fill="black" transform="rotate(0,328,304)"></polygon>
            <polygon class="arrowhead" points="336,80 324,74.4 324,85.6" fill="black" transform="rotate(0,328,80)"></polygon>
            <polygon class="arrowhead" points="136,112 124,106.4 124,117.6" fill="black" transform="rotate(180,128,112)"></polygon>
            <polygon class="arrowhead" points="88,136 76,130.4 76,141.6" fill="black" transform="rotate(270,80,136)"></polygon>
            <g class="text">
              <text x="148" y="68">1.</text>
              <text x="176" y="68">DNS</text>
              <text x="220" y="68">Lookup</text>
              <text x="272" y="68">(CAA)</text>
              <text x="408" y="68">DNS</text>
              <text x="460" y="68">Resolver</text>
              <text x="36" y="84">ACME</text>
              <text x="84" y="84">Client</text>
              <text x="232" y="164">DNS</text>
              <text x="284" y="164">Response</text>
              <text x="392" y="164">example.com</text>
              <text x="456" y="164">CAA</text>
              <text x="376" y="180">Record:</text>
              <text x="148" y="212">2.</text>
              <text x="188" y="212">Select</text>
              <text x="244" y="212">issuer</text>
              <text x="292" y="212">(CA)</text>
              <text x="392" y="212">example.com</text>
              <text x="184" y="228">based</text>
              <text x="220" y="228">on</text>
              <text x="268" y="228">priority</text>
              <text x="360" y="228">CAA</text>
              <text x="384" y="228">0</text>
              <text x="416" y="228">issue</text>
              <text x="492" y="228">"ca.example"</text>
              <text x="148" y="292">3.</text>
              <text x="192" y="292">Connect</text>
              <text x="252" y="292">issuer</text>
              <text x="300" y="292">(CA)</text>
              <text x="428" y="308">https://ca.example</text>
              <text x="448" y="324">.well-known</text>
              <text x="516" y="324">acme</text>
              <text x="484" y="372">Redirect</text>
              <text x="460" y="388">or</text>
              <text x="496" y="388">alias</text>
              <text x="140" y="420">ACME</text>
              <text x="200" y="420">Directory</text>
              <text x="268" y="420">Object</text>
              <text x="444" y="436">https://acme.ca.example/</text>
            </g>
          </svg><a href="#section-3-1.1" class="pilcrow">¶</a>
</div>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3-2">
<li id="section-3-2.1">
          <p id="section-3-2.1.1">The ACME client initiates a DNS lookup to retrieve the CAA record(s) according to <span>[<a href="#RFC8659" class="cite xref">RFC8659</a>]</span>.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-2.1.2">
<li id="section-3-2.1.2.1">
              <p id="section-3-2.1.2.1.1">The DNS resolver responds with the CAA record for each domain, specifying the authorized CAs capable of issuing certificates, along with their priorities and other optional parameters.<a href="#section-3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</li>
        <li id="section-3-2.2">
          <p id="section-3-2.2.1">The ACME client analyzes the valid CAA records for the domain, ignoring any it cannot process, and selects the CA with the highest priority.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.3">
          <p id="section-3-2.3.1">The ACME client will download the ACME directory from the well-known location of the issuer-domain-name of the selected CA (https://[issuer-domain-name]/.well-known/acme)<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.4">
          <p id="section-3-2.4.1">If the directory object indicates that an External Account Binding is required, but this is not configured on the ACME client, the client will try to determine an alternative common CA in step 2.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-2.4.2">
<li id="section-3-2.4.2.1">
              <p id="section-3-2.4.2.1.1">If no alternative CA can be found, the process will end with a failure and the user <span class="bcp14">SHOULD</span> be notified.<a href="#section-3-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</li>
        <li id="section-3-2.5">
          <p id="section-3-2.5.1">The ACME client continues normal operation according to <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span>.<a href="#section-3-2.5.1" class="pilcrow">¶</a></p>
</li>
      </ol>
</section>
</div>
<div id="caa-record">
<section id="section-4">
      <h2 id="name-caa-record">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-caa-record" class="section-name selfRef">CAA Record</a>
      </h2>
<div id="extensions-to-the-caa-record">
<section id="section-4.1">
        <h3 id="name-extensions-to-the-caa-recor">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-extensions-to-the-caa-recor" class="section-name selfRef">Extensions to the CAA Record</a>
        </h3>
<p id="section-4.1-1">This document defines the "discovery" and "priority" CAA parameters in the context of ACME auto discovery.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="the-discovery-parameter">
<section id="section-4.1.1">
          <h4 id="name-the-discovery-parameter">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-the-discovery-parameter" class="section-name selfRef">The "discovery" Parameter</a>
          </h4>
<p id="section-4.1.1-1">The "discovery" parameter is used to control the auto-discovery functionality of the record in the context of this document.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">The value of this parameter, if specified, <span class="bcp14">MUST</span> be a lower-case Boolean, where "true" indicates that this record can be used for auto discovery, and "false" indicates that this record should not be used for auto discovery.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">When this parameter is not specified the client <span class="bcp14">MUST</span> assume that discovery is enabled.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-priority-parameter">
<section id="section-4.1.2">
          <h4 id="name-the-priority-parameter">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-the-priority-parameter" class="section-name selfRef">The "priority" Parameter</a>
          </h4>
<p id="section-4.1.2-1">The value of this parameter, if specified, <span class="bcp14">MUST</span> contain an integer greater than zero, where the value "1" represents the highest priority, and subsequent values like "2", "3", and so on, indicate progressively lower priorities. Where records specify an equal priority, their usage <span class="bcp14">SHOULD</span> be randomized.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">In the case that this parameter is not specified, the entry will be considered to have a lower priority than all entries which specify any priority.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-4.2">
        <h3 id="name-examples">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
        </h3>
<p id="section-4.2-1">This section shows some examples of how CAA records can be configured in the context of ACME auto discovery. CAA records are used to authorize Certification Authorities (CAs) to issue certificates for a specific domain name.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Implementers and operators should carefully configure CAA records according to their specific requirements and considerations.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div id="single-ca">
<section id="section-4.2.1">
          <h4 id="name-single-ca">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-single-ca" class="section-name selfRef">Single CA</a>
          </h4>
<p id="section-4.2.1-1">A simple CAA record allows the issuance of certificates from a single designated CA. In the following example, the CAA record for the domain "example.com" authorizes the CA "ca.example" to issue certificates. However, it does not specify any backup CA. Consequently, if the authorized CA is unable to issue the requested certificate, the certificate issuance will fail.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-4.2.1-2">
<pre>
example.com CAA 0 issue "ca.example"
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="multiple-cas-with-priority">
<section id="section-4.2.2">
          <h4 id="name-multiple-cas-with-priority">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-multiple-cas-with-priority" class="section-name selfRef">Multiple CAs with priority</a>
          </h4>
<p id="section-4.2.2-1">By default, when multiple CAA records are present, the CAs are randomized to distribute the load. However, some users may have preferences regarding the order in which CAs are attempted for certificate issuance. To explicitly specify the order, the "priority" parameter can be used.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">In the next example, the domain "example.com" has two CAA records. The CAA record with "ca2.example" has a higher priority value of 1, indicating it should be attempted first. The CAA record with "ca1.example" has a lower priority value of 2, indicating it should be attempted second.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-4.2.2-3">
<pre>
example.com CAA 0 issue "ca1.example; priority=2"
example.com CAA 0 issue "ca2.example; priority=1"
</pre><a href="#section-4.2.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2.2-4">CAA records that do not explicitly specify a priority are automatically assigned the lowest priority. In cases where multiple CAA records have the same priority, the usage will be randomized.<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2.2-5">Consider the following example, where the domain "example.com" has three CAA records. The CAA record with "ca1.example" has no specified priority, and thus it is assigned the lowest priority. The CAA records with "ca2.example" and "ca3.example" both have a priority of 1. In this scenario, the ACME client will first attempt to obtain its configuration from either "ca2.example" or "ca3.example", selected at random. If both of those fail, it will fall back to "ca1.example". If all attempts fail, the certificate issuance will ultimately fail.<a href="#section-4.2.2-5" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-4.2.2-6">
<pre>
example.com CAA 0 issue "ca1.example"
example.com CAA 0 issue "ca2.example; priority=1"
example.com CAA 0 issue "ca3.example; priority=1"
</pre><a href="#section-4.2.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="using-validationmethods">
<section id="section-4.2.3">
          <h4 id="name-using-validationmethods">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-using-validationmethods" class="section-name selfRef">Using validationmethods</a>
          </h4>
<p id="section-4.2.3-1">Furthermore, it is possible to configure CAA records to indicate a preference for specific types of certificates, which can be indicated by using the <code>validationmethods</code> CAA extension defined in <span>[<a href="#RFC8657" class="cite xref">RFC8657</a>]</span>. In the following example, the domain "example.com" prefers Extended Validation (EV) certificates issued by "ca1.example". If the issuance of an EV certificate fails, the ACME client will attempt to obtain any type of certificate from "ca1.example". If that also fails, it will then try to obtain any type of certificate from "ca2.example".<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-4.2.3-2">
<pre>
example.com CAA 0 issue "ca1.example; priority=1 validationmethods=ca-ev"
example.com CAA 0 issue "ca1.example; priority=2"
example.com CAA 0 issue "ca2.example; priority=3"
</pre><a href="#section-4.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="using-issuewild">
<section id="section-4.2.4">
          <h4 id="name-using-issuewild">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-using-issuewild" class="section-name selfRef">Using issuewild</a>
          </h4>
<p id="section-4.2.4-1">When an ACME client requests the issuance of a wildcard certificate, the issuewild CAA property takes precedence over each issue property when specified, see also section 4.3 of <span>[<a href="#RFC8659" class="cite xref">RFC8659</a>]</span>. The following example specifies that only ca3.example can issue certificates for "<em>.example.com" or "</em>.sub.example.com". However ca3.example is not permitted to issue for "example.com" or "sub.example.com". In the case the issuewild property was not specified all listed CAs would be authorized to issue wildcards for this domain.<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-4.2.4-2">
<pre>
example.com CAA 0 issue "ca1.example; priority=1"
example.com CAA 0 issue "ca2.example; priority=2"
example.com CAA 0 issuewild "ca3.example; priority=3"
</pre><a href="#section-4.2.4-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.4-3">To disable auto discovery for a particular record users can set the discovery parameter to false, in the example below this will ensure that the ACME client will only try to obtain a certificate from ca1.example and ignore ca2.example.<a href="#section-4.2.4-3" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-4.2.4-4">
<pre>
example.com CAA 0 issue "ca1.example"
example.com CAA 0 issue "ca2.example; discovery=false"
</pre><a href="#section-4.2.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="using-accounturi">
<section id="section-4.2.5">
          <h4 id="name-using-accounturi">
<a href="#section-4.2.5" class="section-number selfRef">4.2.5. </a><a href="#name-using-accounturi" class="section-name selfRef">Using accounturi</a>
          </h4>
<p id="section-4.2.5-1">Some cases may arise where the ACME request does not contain sufficient information to uniquely identify the account within the CA that this request should be processed against. Auto-discovery potentially exacerbates these cases since it assumes that explicit client configuration such as External Account Binding tokens are not available, and that ACME account keys may not uniquely identify a CA account. The following example demonstrates using the <code>accounturi</code> CAA paremeter, as defined in <span>[<a href="#RFC8657" class="cite xref">RFC8657</a>]</span>.<a href="#section-4.2.5-1" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-4.2.5-2">
<pre>
example.com CAA 0 issue "ca1.example; priority=1; accounturi=https://ca1.example/account/1234"
example.com CAA 0 issue "ca2.example; priority=2"
</pre><a href="#section-4.2.5-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.5-3">The primary function of <code>accounturi</code>, as stated in <span>[<a href="#RFC8657" class="cite xref">RFC8657</a>]</span> is to indicate which CA accounts are authorized to issue certificates for <code>example.com</code>. The <code>accounturi</code> parameter retains this function here, but may additionally be consulted by the CA in order to resolve account ambiguity arising from auto-discovered ACME requests. When multiple <code>accounturi</code>s are specified for the same CA, the <code>priority</code> parameter <span class="bcp14">MAY</span> be used to indicate to the CA the subscriber's preferred order for using CA accounts with auto-discovered ACME requests. The CA <span class="bcp14">SHOULD</span> first attempt to issue against the <code>accounturi</code> with the lowest <code>priority</code> value, and then fall back to <code>accounturi</code>s with higher priority values if the issuance fails.<a href="#section-4.2.5-3" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-4.2.5-4">
<pre>
example.com CAA 0 issue "ca1.example; priority=1; accounturi=https://ca1.example/account/1234"
example.com CAA 0 issue "ca1.example; priority=2; accounturi=https://ca1.example/account/1235"
</pre><a href="#section-4.2.5-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2.5-5">Domain owners <span class="bcp14">SHOULD</span> configure their CAA records so that the <code>accounturi</code> that is intended to be used with auto-discovered ACME requests is associated with the CAA record of the lowest priority value. For example, a domain owner could configure their CAA records as follows to indicate that accounts 1234, 1235, and 1236 are all authorized to issue for <code>example.com</code>, but that account 1234 <span class="bcp14">SHOULD</span> be used for ambiguous requests.<a href="#section-4.2.5-5" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-4.2.5-6">
<pre>
example.com CAA 0 issue "ca1.example; priority=1; accounturi=https://ca1.example/account/1234"
example.com CAA 0 issue "ca1.example; priority=2; accounturi=https://ca1.example/account/1235"
example.com CAA 0 issue "ca1.example; priority=2; accounturi=https://ca1.example/account/1236"
</pre><a href="#section-4.2.5-6" class="pilcrow">¶</a>
</div>
<p id="section-4.2.5-7">Since an omitted <code>priority</code> parameter implies the lowest priority, this could equivalently be written as:<a href="#section-4.2.5-7" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-4.2.5-8">
<pre>
example.com CAA 0 issue "ca1.example; priority=1; accounturi=https://ca1.example/account/1234"
example.com CAA 0 issue "ca1.example; accounturi=https://ca1.example/account/1235"
example.com CAA 0 issue "ca1.example; accounturi=https://ca1.example/account/1236"
</pre><a href="#section-4.2.5-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acme-client-configuration">
<section id="section-5">
      <h2 id="name-acme-client-configuration">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-acme-client-configuration" class="section-name selfRef">ACME Client Configuration</a>
      </h2>
<p id="section-5-1">To enable the ACME client to obtain the necessary configuration information for interacting with the authorized Certification Authority (CA)'s ACME server, a mechanism leveraging the well-known directory is proposed.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The well-known directory is a standardized location within the domain's web server where clients can discover specific resources or configurations. In the context of ACME client configuration retrieval, a copy of the ACME directory object or a redirect to it is placed in the well-known directory of the CA's domain, which is specified as a constraint in the CAA record. This allows the ACME client to conveniently retrieve the required configuration.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">For instance, when the CAA record restricts certificate issuance to the CA "ca.example" for the domain "example.com", the ACME client retrieves the ACME directory object as specified in Section 7.1.1 of ACME <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span> from the URL "https://ca.example/.well-known/acme".<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">While an alternative consideration was to include the ACME server address directly as a parameter in the CAA record, it was determined that this approach could introduce clutter and significantly increase the size of the record. Additionally, a rigid binding between the CAA record and the ACME server address may present challenges if the CA needs to change its server address in the future.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">Thus, the approach outlined in this document, utilizing the well-known directory for ACME client configuration retrieval, offers flexibility for CAs to manage and update their ACME server addresses while maintaining a concise and focused CAA record.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">It is important for implementers and operators to ensure the availability and accessibility of the ACME directory object within the well-known directory to facilitate successful ACME client configuration retrieval.<a href="#section-5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-behavior">
<section id="section-6">
      <h2 id="name-acme-client-behavior">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-acme-client-behavior" class="section-name selfRef">ACME Client Behavior</a>
      </h2>
<p id="section-6-1">Prior to establishing a connection with the default ACME server or a pool of ACME servers, the ACME client verifies the presence of any configured CA Authorization records (CAA) as defined in <span>[<a href="#RFC8659" class="cite xref">RFC8659</a>]</span>. If a CAA record is found, the ACME client will attempt to obtain a certificate from the CA with the highest priority. If the certificate issuance attempt fails, the client will proceed to lower-priority CAs in an attempt to obtain the certificate.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">In the event of a failed attempt to obtain a certificate from a particular CA, the ACME client employs a retry mechanism to ensure successful certificate acquisition. However, in cases where certain CAs are known to be temporarily unavailable, the ACME client <span class="bcp14">MAY</span> choose to ignore those CAs for a limited period of time. By temporarily excluding unresponsive CAs from the issuance process, the client can optimize its certificate acquisition strategy and enhance overall efficiency. This approach helps mitigate potential delays caused by unresponsive CAs and allows the client to focus on viable options for obtaining the required certificate.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">ACME clients <span class="bcp14">SHOULD</span> notify the user if the enrollment of a certificate from a specific CA fails multiple times, even if the client successfully obtains a certificate from an alternative CA. This notification is essential to ensure that users are promptly informed about recurring enrollment failures, allowing them to take appropriate measures. By providing such notifications, clients enable users to assess and address any underlying issues, seek alternative solutions, or make informed decisions regarding their certificate management processes.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">In order to promote the adoption of ACME in Enterprise environments, it is crucial for implementers and operators to recognize the significance of External Account Bindings. The section dedicated to External Account Bindings provides valuable information and guidelines for effectively incorporating this feature.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="certificates-with-multiple-domain-names">
<section id="section-6.1">
        <h3 id="name-certificates-with-multiple-">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-certificates-with-multiple-" class="section-name selfRef">Certificates with multiple domain names</a>
        </h3>
<p id="section-6.1-1">When the ACME client initiates a certificate request for multiple domain names, it is required to check the CAA records for each domain. The purpose of this check is to identify a Certification Authority (CA) that is authorized by all the domain names intended to be included in the certificate. If, during the evaluation of CAA records, no common CA can be identified that satisfies the authorization requirements of all the domain names, the certificate issuance process will fail.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">To mitigate the risk of encountering failures in the certificate issuance process due to incompatible CAA records, it is crucial to ensure that certificates only include domain names that are under the control of the same entity. By maintaining a consistent ownership and control of the domain names included in a certificate, the likelihood of encountering authorization conflicts among CAA records is minimized. This practice promotes a more streamlined and reliable certificate issuance process, reducing the potential for errors and ensuring that the certificate accurately represents the domains controlled by a single entity.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">The process with multiple domain names looks as follows:<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-4">
<li id="section-6.1-4.1">
            <p id="section-6.1-4.1.1">The ACME client identifies the list of domain names for which a certificate is requested.<a href="#section-6.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-4.2">
            <p id="section-6.1-4.2.1">For each domain in the list, the ACME client initiates a DNS lookup to retrieve the CAA record(s) according to <span>[<a href="#RFC8659" class="cite xref">RFC8659</a>]</span>.<a href="#section-6.1-4.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-4.2.2">
<li id="section-6.1-4.2.2.1">
                <p id="section-6.1-4.2.2.1.1">The DNS resolver responds with the CAA record for each domain, specifying the authorized CAs capable of issuing certificates, along with their priorities and other optional parameters.<a href="#section-6.1-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
          <li id="section-6.1-4.3">
            <p id="section-6.1-4.3.1">The ACME client analyzes the valid CAA records for each domain to identify a CA that is authorized by all included domains and which has the highest priority while it ignores any CAA records it cannot process.<a href="#section-6.1-4.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-4.3.2">
<li id="section-6.1-4.3.2.1">
                <p id="section-6.1-4.3.2.1.1">If all domains prioritize the same CA, the ACME client proceeds with step 4.<a href="#section-6.1-4.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.1-4.3.2.2">
                <p id="section-6.1-4.3.2.2.1">If not all domains prioritize the same CA, the ACME client tries to find a compromise based on the highest overall preference.<a href="#section-6.1-4.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-6.1-4.3.2.3">
                <p id="section-6.1-4.3.2.3.1">If no compromise can be found, the process will end with a failure and the user <span class="bcp14">SHOULD</span> be notified.<a href="#section-6.1-4.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
          <li id="section-6.1-4.4">
            <p id="section-6.1-4.4.1">The ACME client will download the ACME directory from the well-known location of the issuer-domain-name of the selected CA (https://[issuer-domain-name]/.well-known/acme)<a href="#section-6.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-4.5">
            <p id="section-6.1-4.5.1">If an External Account Binding is required but not configured the ACME client will try to determine an alternative CA in step 3.<a href="#section-6.1-4.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-4.5.2">
<li id="section-6.1-4.5.2.1">
                <p id="section-6.1-4.5.2.1.1">If no alternative CA can be found, the process with end with a failure and the user <span class="bcp14">SHOULD</span> be notified.<a href="#section-6.1-4.5.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
          <li id="section-6.1-4.6">
            <p id="section-6.1-4.6.1">The ACME clients continues normal operation according to <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span>.<a href="#section-6.1-4.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<div id="selecting-a-ca-through-compromise">
<section id="section-6.1.1">
          <h4 id="name-selecting-a-ca-through-comp">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-selecting-a-ca-through-comp" class="section-name selfRef">Selecting a CA through Compromise</a>
          </h4>
<p id="section-6.1.1-1">In the example below, we have three domains: "one.example", "two.example", and "three.example". Among these domains, "one.example" and "three.example" prioritize "ca1.example", while "two.example" prioritizes "ca2.example" over "ca1.example". To select a Certification Authority (CA), a compromise on the priority needs to be established.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">Based on the priorities specified, "ca1.example" is preferred by two out of the three domains. Since "ca1.example" is authorized by all domains and has the highest overall preference, it is selected as the CA to continue the process.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<div class="lang-dns-rr sourcecode" id="section-6.1.1-3">
<pre>
one.example CAA 0 issue "ca1.example; priority=1"
one.example CAA 0 issue "ca2.example; priority=2"

two.example CAA 0 issue "ca1.example; priority=2"
two.example CAA 0 issue "ca2.example; priority=1"

three.example CAA 0 issue "ca1.example; priority=1"
three.example CAA 0 issue "ca2.example; priority=2"
</pre><a href="#section-6.1.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="implementation-considerations">
<section id="section-7">
      <h2 id="name-implementation-consideratio">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<div id="external-account-binding">
<section id="section-7.1">
        <h3 id="name-external-account-binding">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-external-account-binding" class="section-name selfRef">External Account Binding</a>
        </h3>
<p id="section-7.1-1">Clients <span class="bcp14">SHOULD</span> provide users with the ability to configure and utilize external account bindings per CA or ACME server, as it offers enhanced security and flexibility in managing the certificate provisioning process.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">External account bindings are not only crucial for users seeking to provision certificates with stronger authentication requirements such as Organization Validated (OV), Extended Validation (EV), and Qualified Website Authentication Certificates (QWAC), but they can also be applicable to Domain Validation (DV) certificates covered by a commercial agreement. By offering the configuration option for external account bindings, clients enable users to establish a secure association between their ACME accounts and external accounts, facilitating streamlined and authenticated certificate issuance processes. This flexibility accommodates a wide range of certificate types and use cases, ensuring that users can provision certificates with the appropriate level of authentication based on their specific requirements, whether they be DV certificates covered by a commercial agreement or certificates with higher levels of validation. Therefore, it is essential for clients to implement the external account binding configuration option to support the diverse needs of users in obtaining certificates with varying authentication levels.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">It is crucial for Certification Authorities (CAs) to carefully consider the internal account binding mechanisms described in this document. This is especially critical given the current lack of widespread support for external account bindings in user interfaces, with only a few command line utilities offering such functionality. By recognizing and implementing the internal account binding approach, CAs can provide a viable alternative for users who may not have access to or be familiar with external account binding options. This will help ensure a seamless and secure account linkage process, even in situations where the availability of external account binding configurations is limited.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<div id="internal-account-binding-using-domain-control-validation">
<section id="section-7.1.1">
          <h4 id="name-internal-account-binding-us">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-internal-account-binding-us" class="section-name selfRef">Internal Account Binding using Domain Control Validation</a>
          </h4>
<p id="section-7.1.1-1">In addition to the external account binding mechanism, an alternative approach can be implemented by the CAs that offers distinct advantages, particularly in cases where service providers may not expose the account binding configuration options to their users. This alternative method leverages domain control validation as the initial step in the process and subsequently pauses to await confirmation from the account holder regarding the account binding. The email address associated with the ACME account can be utilized for differentiating between multiple Certification Authority (CA) accounts holding the same domain name.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.1-2">The process to establish an internal account binding would be as follows:<a href="#section-7.1.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1.1-3">
<li id="section-7.1.1-3.1">
              <p id="section-7.1.1-3.1.1">The user adds the domain name to their Certification Authority (CA) account and completes the domain control verification process within this account.<a href="#section-7.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.1.1-3.2">
              <p id="section-7.1.1-3.2.1">The user initiates the ACME process for certificate issuance or a new authorization.<a href="#section-7.1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.1.1-3.3">
              <p id="section-7.1.1-3.3.1">The ACME client validates domain control for the requested domain.<a href="#section-7.1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.1.1-3.4">
              <p id="section-7.1.1-3.4.1">Upon successful domain control validation the CA does not mark the authorizations as completed but awaits the completion of the account binding.<a href="#section-7.1.1-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.1.1-3.5">
              <p id="section-7.1.1-3.5.1">The CA, having confirmed domain control, uses the provided email address associated with the ACME account to distinguish between different CA accounts that have confirmed control over the same domain name.<a href="#section-7.1.1-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.1.1-3.6">
              <p id="section-7.1.1-3.6.1">The account holder receives a notification or prompt and confirms the account binding within the CA's system.<a href="#section-7.1.1-3.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.1.1-3.7">
              <p id="section-7.1.1-3.7.1">Once the account binding is confirmed, the CA marks the ACME authorization as completed and the ACME client proceeds with the remaining steps of the ACME process, such as finalizing the certificate issuance.<a href="#section-7.1.1-3.7.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-7.1.1-4">It is important to note that before the ACME process can start, the domain name must be added to the CA account and the domain control validation process must be successfully completed. This ensures that the domain ownership is verified for both accounts before proceeding with the account binding.<a href="#section-7.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="internal-account-binding-using-email-address">
<section id="section-7.1.2">
          <h4 id="name-internal-account-binding-usi">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-internal-account-binding-usi" class="section-name selfRef">Internal Account Binding using Email Address</a>
          </h4>
<p id="section-7.1.2-1">When ACME clients provide the email address associated with the user's account during the creation of a new account, Certification Authorities (CAs) can utilize this email address to establish an internal account binding between the ACME account and the corresponding customer account within their internal systems. This approach offers an alternative method for establishing the account linkage, particularly in cases where the ACME integration's user interface does not provide explicit external account binding configuration options.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2-2">However, it is crucial to acknowledge that this internal account binding mechanism introduces potential vulnerabilities, particularly in relation to phishing attacks. It is imperative to exercise caution when utilizing this mechanism since the email address associated with the ACME account is not verified, and the account binding request can be initiated by any party. Careful consideration should be given to the security implications of relying solely on the email address for establishing the account linkage.<a href="#section-7.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terms-of-service-and-acceptance">
<section id="section-7.2">
        <h3 id="name-terms-of-service-and-accept">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-terms-of-service-and-accept" class="section-name selfRef">Terms of Service and Acceptance</a>
        </h3>
<p id="section-7.2-1">The terms of service associated with different CAs can vary, and it is important to consider how these terms are handled within the context of auto-discovery.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div id="implicit-acceptance-of-terms-of-service">
<section id="section-7.2.1">
          <h4 id="name-implicit-acceptance-of-term">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-implicit-acceptance-of-term" class="section-name selfRef">Implicit Acceptance of Terms of Service</a>
          </h4>
<p id="section-7.2.1-1">As the ACME client is not explicitly controlled by the user in a shared environment, the user's explicit approval of the terms of service presented by the CA becomes challenging. In the absence of a direct user interaction with the ACME client, it is assumed that the user accepts the terms of service by explicitly configuring the CAA record to authorize the CA.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">CAs will typically provide documentation indicating how to configure a domain's CAA record for ACME auto-discovery and are encouraged to note in alongside those instructions that doing so will be taken as implicit agreement to the Terms of Service, and also to include a direct link to those Terms of Service.<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.2.1-3">ACME clients are strongly encouraged to display the relevant terms of service for the obtained certificates to ensure users have visibility into the associated obligations and restrictions. This helps users make informed decisions about their certificate management and ensures compliance with the terms of service set by the authorized CA.<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acceptance-through-caa-parameter">
<section id="section-7.2.2">
          <h4 id="name-acceptance-through-caa-para">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-acceptance-through-caa-para" class="section-name selfRef">Acceptance Through CAA Parameter</a>
          </h4>
<p id="section-7.2.2-1">One potential enhancement to address the explicit acceptance of terms of service is the inclusion of a CAA parameter called "termsOfServiceAgreed". This parameter would provide a direct mechanism for users to indicate their agreement to the terms of service.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">However, it is important to consider the trade-offs associated with adding this type of data to the CAA record. The inclusion of additional attributes can be perceived as clutter and may increase the complexity of configuring the CAA record. Therefore, the authors of this document recommend relying on the implicit acceptance of the terms of service.<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2.2-3">By configuring the CAA record to authorize a specific CA, users implicitly indicate their acceptance of the associated terms of service. This approach strikes a balance between simplicity and compliance with the CA's requirements. It is crucial for ACME clients to display the relevant terms of service for the obtained certificates, ensuring that users have visibility and can make informed decisions regarding their certificate management.<a href="#section-7.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-iana">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="well-known-uri-for-the-acme-directory">
<section id="section-8.1">
        <h3 id="name-well-known-uri-for-the-acme">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-well-known-uri-for-the-acme" class="section-name selfRef">Well-Known URI for the ACME Directory</a>
        </h3>
<p id="section-8.1-1">The following value has been registered in the "Well-Known URIs" registry (using the template from <span>[<a href="#RFC5785" class="cite xref">RFC5785</a>]</span>):<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-2">
<pre>
URI suffix: acme
Change controller: IETF
Specification document(s): RFC XXXX, Section Y.Z
Related information: N/A
</pre><a href="#section-8.1-2" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1-3.1">
            <p id="section-8.1-3.1.1"><strong>RFC Editor's Note:</strong> Please replace XXXX above with the RFC number assigned to this document<a href="#section-8.1-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="caa-parameters">
<section id="section-8.2">
        <h3 id="name-caa-parameters">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-caa-parameters" class="section-name selfRef">CAA Parameters</a>
        </h3>
<p id="section-8.2-1">As per <span>[<a href="#RFC8659" class="cite xref">RFC8659</a>]</span>, the parameter namespace for the CAA "issue" and "issuewild" Properties has CA-defined semantics, and the identifiers within that namespace may be freely and arbitrarily assigned by a CA. This document merely specifies recommended semantics for parameters of the names "discovery" and "priority", which CAs may choose to adopt.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.2-2.1">
            <p id="section-8.2-2.1.1"><strong>RFC Editor's Note:</strong>  Please remove this section prior to publication of a final version of this document.<a href="#section-8.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-8.2-2.1.2">Although there is no requirement for a RFC 8659-compliant CA to process parameters, having a list of parameters whose recommended semantics have been defined would likely be useful. Therefor the authors of this document have the intention to establishing a CAA parameter registry in another document.<a href="#section-8.2-2.1.2" class="pilcrow">¶</a></p>
<p id="section-8.2-2.1.3">See also: https://github.com/vanbroup/acme-auto-discovery/issues/14<a href="#section-8.2-2.1.3" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="risks-with-auto-discovery-of-authorized-cas">
<section id="section-9.1">
        <h3 id="name-risks-with-auto-discovery-o">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-risks-with-auto-discovery-o" class="section-name selfRef">Risks with Auto-Discovery of Authorized CAs</a>
        </h3>
<p id="section-9.1-1">The mechanism described in this document relies on the DNS Certification Authority Authorization (CAA) Resource Record <span>[<a href="#RFC8659" class="cite xref">RFC8659</a>]</span> to determine the authorized Certification Authorities (CAs) capable of issuing certificates for a given domain name(s). However, there are potential risks associated with the automatic provisioning of certificates without an explicit indication from the user.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<div id="unexpected-certificate-issuance">
<section id="section-9.1.1">
          <h4 id="name-unexpected-certificate-issu">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-unexpected-certificate-issu" class="section-name selfRef">Unexpected Certificate Issuance</a>
          </h4>
<p id="section-9.1.1-1">Where the issuance of certificates is currently restricted through CAA records and certificates are provisioned through alternative means (i.e., manual or via a proprietary API) certificates can unexpectedly be replaced with a similar certificate or a certificate of a different type (e.g., DV versus EV) if the ACME client supports this new mechanism.<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1.1-2">Its recommended that users who which to obtain certificates attesting to more than domain validation (DV) control, restrict the validation method using a CA specific “validationmethods” CAA parameter value (e.g., “ca-ov”, “ca-ev”, “ca-qwac”) as specified by <span>[<a href="#RFC8657" class="cite xref">RFC8657</a>]</span>.<a href="#section-9.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance-by-the-wrong-authorized-ca">
<section id="section-9.1.2">
          <h4 id="name-issuance-by-the-wrong-autho">
<a href="#section-9.1.2" class="section-number selfRef">9.1.2. </a><a href="#name-issuance-by-the-wrong-autho" class="section-name selfRef">Issuance by the ‘wrong’ authorized CA</a>
          </h4>
<p id="section-9.1.2-1">In scenarios where a domain name authorizes multiple CAs without specifying a weight or preference attribute, there is a risk that the ACME client may unexpectedly request a certificate from one of the authorized CAs that was only included as backup.
To mitigate this risk, it is recommended that users who have multiple CAA records explicitly configure the CAA record to include a weight or preference attribute to indicate their desired CA for certificate issuance.<a href="#section-9.1.2-1" class="pilcrow">¶</a></p>
<p id="section-9.1.2-2">Additionally, ACME clients should provide clear visibility and feedback to users regarding the CA from which certificates will be obtained, ensuring that it aligns with their expectations.<a href="#section-9.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="malicious-acme-servers">
<section id="section-9.2">
        <h3 id="name-malicious-acme-servers">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-malicious-acme-servers" class="section-name selfRef">Malicious ACME Servers</a>
        </h3>
<p id="section-9.2-1">One potential security risk associated with the mechanism defined in this document is the possibility of domain owners placing links to malicious ACME servers into their DNS CAA Resource Records in order to attack the infrastructure of hosting providers. Malicious actors could exploit vulnerabilities in the ACME client implementation or inject malicious code, potentially leading to unauthorized access or remote code execution on the client's system.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">To minimize this risk, ACME clients must be written with a cautious and security-conscious approach when interacting with ACME servers. It is crucial not to blindly trust servers to behave securely and in accordance with the ACME protocol.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-of-acme-keys">
<section id="section-9.3">
        <h3 id="name-authorization-of-acme-keys">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-authorization-of-acme-keys" class="section-name selfRef">Authorization of ACME Keys</a>
        </h3>
<p id="section-9.3-1">To ensure a secure account binding, it is essential that each customer is able to control and pre-approve the ACME account keys that are authorized to request certificates against their account or that have additional verification requirements beyond what can be done inline within the ACME protocol, such as OV, EV [<span>[<a href="#BR" class="cite xref">BR</a>]</span>], Qualified Website [<span>[<a href="#QWAC" class="cite xref">QWAC</a>]</span>], or Verified Mark Certificates [<span>[<a href="#VMC" class="cite xref">VMC</a>]</span>].<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">This binding is accomplished via External Account Binding (EAB) keys or via unique ACME account keys per CA account. In the deployments for which ACME auto-discovery is envisioned to be useful, these authorization mechanisms may not be appropriate because the ACME client may be under the control of a Cloud Service Provider (CSP) who may use the same ACME client key for all requests across customer accounts and who does not know the customer's EAB key (and if it did, then it would not require an auto-discovery mechanism in the first place).<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3-3">The mechanism by which a CA obtains authorization to accept requests from a given ACME client key against a given CA account is outside the scope of this document. Such a mechanism should be designed carefully to not lower the overall security of the system, and to not prevent CSPs from being able to rotate client keys.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-dns-security">
<section id="section-9.4">
        <h3 id="name-use-of-dns-security">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-use-of-dns-security" class="section-name selfRef">Use of DNS Security</a>
        </h3>
<p id="section-9.4-1">The use of DNSSEC to authenticate CAA RRs is strongly <span class="bcp14">RECOMMENDED</span> but not required. In scenarios where DNSSEC is not utilized, there is a potential risk wherein the ACME client may be compelled to request a certificate from an alternative ACME server, which could be malicious in nature.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">In the context of the public PKI, a compliant CA associated with the ACME server will deny such unauthorized requests if it was not delegated the authority through a CAA record. However, for ACME servers that operate outside the scope of public trust and may have malicious intentions, the ACME client can validate certificates against it local root store, thus identifying and mitigating this potential attack.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8555">https://www.rfc-editor.org/rfc/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8659">[RFC8659]</dt>
      <dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refAuthor">Stradling, R.</span>, and <span class="refAuthor">J. Hoffman-Andrews</span>, <span class="refTitle">"DNS Certification Authority Authorization (CAA) Resource Record"</span>, <span class="seriesInfo">RFC 8659</span>, <span class="seriesInfo">DOI 10.17487/RFC8659</span>, <time datetime="2019-11" class="refDate">November 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8659">https://www.rfc-editor.org/rfc/rfc8659</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BR">[BR]</dt>
        <dd>
<span class="refAuthor">CA/Browser Forum</span>, <span class="refTitle">"Baseline Requirements for the Issuance and Management of Publicly‐Trusted TLS Server Certificates"</span>, <span>n.d.</span>, <span>&lt;<a href="https://cabforum.org/working-groups/server/baseline-requirements/requirements/">https://cabforum.org/working-groups/server/baseline-requirements/requirements/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EVG">[EVG]</dt>
        <dd>
<span class="refAuthor">CA/Browser Forum</span>, <span class="refTitle">"Guidelines for the Issuance and Management of Extended Validation Certificates"</span>, <span>n.d.</span>, <span>&lt;<a href="https://cabforum.org/working-groups/server/extended-validation/guidelines/">https://cabforum.org/working-groups/server/extended-validation/guidelines/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tweedale-acme-discovery">[I-D.tweedale-acme-discovery]</dt>
        <dd>
<span class="refAuthor">Tweedale, F.</span>, <span class="refTitle">"Automated Certificate Management Environment (ACME) Service Discovery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tweedale-acme-discovery-01</span>, <time datetime="2020-11-16" class="refDate">16 November 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tweedale-acme-discovery-01">https://datatracker.ietf.org/doc/html/draft-tweedale-acme-discovery-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QWAC">[QWAC]</dt>
        <dd>
<span class="refAuthor">ETSI</span>, <span class="refTitle">"Electronic Signatures and Infrastructures (ESI); Policy and security requirements for Trust Service Providers issuing certificates; Part 2: Requirements for trust service providers issuing EU qualified certificates"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.etsi.org/deliver/etsi_en/319400_319499/31941102/">https://www.etsi.org/deliver/etsi_en/319400_319499/31941102/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5785">[RFC5785]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">E. Hammer-Lahav</span>, <span class="refTitle">"Defining Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 5785</span>, <span class="seriesInfo">DOI 10.17487/RFC5785</span>, <time datetime="2010-04" class="refDate">April 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5785">https://www.rfc-editor.org/rfc/rfc5785</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8657">[RFC8657]</dt>
        <dd>
<span class="refAuthor">Landau, H.</span>, <span class="refTitle">"Certification Authority Authorization (CAA) Record Extensions for Account URI and Automatic Certificate Management Environment (ACME) Method Binding"</span>, <span class="seriesInfo">RFC 8657</span>, <span class="seriesInfo">DOI 10.17487/RFC8657</span>, <time datetime="2019-11" class="refDate">November 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8657">https://www.rfc-editor.org/rfc/rfc8657</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VMC">[VMC]</dt>
      <dd>
<span class="refAuthor">BIMI Group</span>, <span class="refTitle">"Guidelines for the Issuance and Management of Extended Validation Certificates"</span>, <span>n.d.</span>, <span>&lt;<a href="https://bimigroup.org/resources/VMC_Requirements_latest.pdf">https://bimigroup.org/resources/VMC_Requirements_latest.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Paul van Brouwershaven</span></div>
<div dir="auto" class="left"><span class="org">Entrust Limited</span></div>
<div dir="auto" class="left"><span class="street-address">2500 Solandt Road – Suite 100</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K2K 3G5</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:paul.vanbrouwershaven@entrust.com" class="email">paul.vanbrouwershaven@entrust.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Ounsworth</span></div>
<div dir="auto" class="left"><span class="org">Entrust Limited</span></div>
<div dir="auto" class="left"><span class="street-address">2500 Solandt Road – Suite 100</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K2K 3G5</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mike.ounsworth@entrust.com" class="email">mike.ounsworth@entrust.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Corey Bonnell</span></div>
<div dir="auto" class="left"><span class="org">DigiCert, Inc</span></div>
<div dir="auto" class="left">
<span class="locality">Pittsburgh</span>, <span class="region">PA</span> </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:corey.bonnell@digicert.com" class="email">corey.bonnell@digicert.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Iñigo Barreira</span></div>
<div dir="auto" class="left"><span class="org">Sectigo (Europe) SL</span></div>
<div dir="auto" class="left"><span class="street-address">Rambla Catalunya 86, 3 1. 08008 Barcelona.</span></div>
<div dir="auto" class="left">
<span class="postal-code">08008</span> <span class="locality">Barcelona</span> </div>
<div dir="auto" class="left"><span class="country-name">Spain</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:inigo.barreira@sectigo.com" class="email">inigo.barreira@sectigo.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Q Misell</span></div>
<div dir="auto" class="left"><span class="org">AS207960 Cyfyngedig</span></div>
<div dir="auto" class="left"><span class="street-address">13 Pen-y-lan Terrace</span></div>
<div dir="auto" class="left"><span class="locality">Caerdydd</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:q@as207960.net" class="email">q@as207960.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
